
# Shoutpoint TelePort Module Starter
### Kick-off TelePort module development with this starter project.

TelePort is an Angular2/TypeScript web application. This repo contains the building blocks to create an external module
that can be used by TelePort Core.


## Requirements

To develop a module for TelePort, you will need to know:
- TypeScript / JavaScript
- Angular2
- General concepts of web development

And install the following on your computer:
- NodeJS >= 6 (LTS) and NPM: https://nodejs.org
- TypeScript `npm i -g typescript`
- Angular CLI: `npm i -g angular-cli`

Suggested IDEs:
- Webstorm
- Visual Studio Code (w/ TypeScript extensions)


---


## Reporting Issues

Report any issues/bugs with this project in GitLab.  
http://gitlab.teramesh.net/patrick.martin/teleport-module-starter/issues


---


## Setup for New Module Development

1) Clone the repo (latest tag release) into the local directory of your choosing (FOLDER-NAME).

*Note: You'll want the latest version. Double-check the repo tags for the latest.*

```
git clone -b '1.0.9' --single-branch --depth 1 http://gitlab.teramesh.net/patrick.martin/teleport-module-starter.git <folder-name>
```

2) Change directories
```
cd <folder-name>
```

3) Create a New Branch
```
git checkout -b master
```

5) Pull down dependencies
```
npm install
```

6) Check that all is well
```
npm run release-build
```

You are now ready to develop the module.

When you are ready to push the new project to its own GitLab repo:

7) Create New Project
- In GitLab, create a new PUBLIC project named `teleport-module-NEW-MODULE-NAME`. Replace `NEW-MODULE-NAME` with the actual name.

8) Add New Remote Repo and Push
```
git remote add origin http://gitlab.teramesh.net/USER.NAME/teleport-module-NEW-MODULE-NAME.git
git add .
git commit -m init
git push -u origin master
```


---


## NPM Scripts

#### `bundle`
Does two things:
- Transpiles the TypeScript files in `/module` and move everything to `/bundle`.
- Compiles all JS, HTML, CSS into file `/module/module.umd.js` for import by **TelePort Core**.

#### `test`
Runs a one-off Karma/Jasmine test on the module.

#### `demo-compile`
Runs `tsc` on the `demo` app. Run this after you make changes in this directory.

#### `demo-run`
Runs `demo-compile`, starts a web server and opens a browser window. You'll need to go to `http://localhost:8080/demo` to
view the app. (http-server does not have a way to start in a subdir. Could solve this with an index.html in root that
redirects, but seems sloppy.)

#### `coverage-build`
Takes the results of `test-once` and builds an HTML coverage report.

#### `coverage-open`
A helper script that opens the coverage report generated by `coverage-build`.

#### `release-build`
Runs a collection of NPM scripts to prepare for a release push. Run this before a GIT PUSH and TAG.


---


## Project Organization

#### /_test_output
HTML report generated by the unit tests.

#### /bundle
The testing/release code compiled from `npm run bundle`.

#### /coverage
HTML report of testing coverage generated by `npm run test-once` and `npm run coverage-build`.

#### /demo
This is a basic web app skeleton. You can use it to test your module in a TelePort-Core-like environment. 
Use `nmp run demp-run` to launch a browser to access it.

#### /module
This is where the actual code for the module goes.


---


## Suggested Changes After Setup

This skeleton repo is meant to help kickoff a new TelePort module. There are some changes you will need to make before
making this available to TelePort Core.

If using WebStorm, it may help performance to exclude the `_test_output`, `bundle`, `coverage` and `demo` directories (right-click dir > Mark Directory as... > Exclude).

##### /pacakge.json
- Change the "name".
- Clean "peerDependencies" to only those your module is using.
- Ensure "peerDependencies" versions match TelePort Core versions.

##### /module/index.ts
- Change the "MyModuleNameModule" class name to match your module's name.
- Any exported dependencies should have conflict-safe names.

##### /README.md
- Rename this `README.md` file to `MODULE_DOCS.md`.
- Rename the `MODULE_README.md` file to `README.md`.

#### General Tips
- If the module is not using routing, delete the `/module/pages` directory and `PagesModule` from `/module/index.ts`.
- Similarly, remove other unused directories like `components`, `directives` and `services`.


---


## Testing

All modules will have unit tests that must pass with at least 90% coverage.

Create companion `*.spec.ts` files for each `*.ts` file under `/module`.

Tests are written in Jasmine: https://jasmine.github.io/2.5/introduction

Become familiar with the joys of Angular2 testing: https://angular.io/docs/ts/latest/guide/testing.html

NOTE: Always share what your learn about Angular2 testing, since we're all new to it.


---


## Release for Use in TelePort Core

Hopefully, this process is very easy. If not, this starter project isn't doing its job.

#### Build the Release
Run `npm run release-build`. If it completes without errors (with +90% coverage), it's ready to be released.

#### Bump Version
Every new release should have a new version. Bump the version in `package.json`.

#### GIT Push, Merge and Tag
Commit changes and push your branch to GitLab. In GitLab, submit a Merge Request to merge the your branch into the `master` branch.

If this is your project, you'll likely just accept the Merge Request yourself. If not, the project's owner will review the
request and 1) Accept the request or 2) Reject the request with comments. Rinse and repeat.

Upon accepting a new version, the project owner will TAG the master branch with a new release version.

Finally, the new version (or whole new module) will be added to TelePort Core. Most likely, this will be the task of the module owner.


---


## Programming Directives

This is copied from TelePort Core's README. There's always a chance this section will be out-of-date. Check TelePort Core for the latest.


#### Reactive and Functional

- By its nature, JS is very reactive and Angular2's use of RxJS only helps make it more so.
- Find functional solutions, avoiding ugly imperative code.


#### External Libraries

Do not use "non-approved" external libraries. If a new library is necessary, get approval from the TelePort project owner.


#### Strict Data Types

Avoid using `any`. TypeScript supports strict data typing. Strong types lets the compiler help find errors in the code before
they get deployed.


#### RxJS Observables

Use RxJS to solve pub/sub, data sharing and data handling problems. There's a great chance that RxJS has a clean solution.


#### Promises

Avoid using Promises. If necessary, leverage async/await (in TypeScript 2.1) for better Promise handling.


#### Strict Immutability

- Use the **Concrete** and **Immutable** libraries for objects and collections.
- Declare all variables with `const` by default. Avoid using `let`. `var` is deprecated.
- Label all interface parameters `readonly`.


#### No NULLs and UNDEFINEDs

Never let a variable be `null` or `undefined`. Use **Monet** library's `Either` and `Maybe`.

The TypeScript compiler will enforce "strictNullChecks".


#### TSLint and Code Style

The tslint.json file is configured to help standardize the code style in TelePort Core and modules. Do not change
the tslint config because you don't like how it requires you to code.


---


## Theming, CSS and Flexbox

Reference at [TelePort Core Wiki](http://gitlab.teramesh.net/patrick.martin/shoutpoint-teleport-core/wikis/css-and-theming).


---


## Third-party Libraries

The list of authorized third-party libraries are in the [TelePort Core Wiki](http://gitlab.teramesh.net/patrick.martin/shoutpoint-teleport-core/wikis/third-party-libraries).

